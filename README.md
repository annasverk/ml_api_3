# Flask-приложение для обучения ML-моделей с поддержкой базы данных и Docker
В рамках выполнения Домашнего задания 2 по курсу "Python: продвинутый уровень" было 
усовершенствовано Flask-приложение для обучения ML-моделей из задания 1:
- Добавлена работа с базой данных Postgres для записи, чтения, изменения и удаления данных о метриках качества обученных моделей
- Добавлена поддержка вычислений не в рамках Flask-приложения, а именно выполнение этапов обучения и предсказания перенесено в отдельный контейнер
- Приложение собрано в Docker-образы
    - Web – работа с приложением через api
    - Worker – обучение моделей и вывод предсказаний 
    - Redis – брокер для celery (образ из DockerHub)
    - Postgres – база данных (образ из DockerHub)
- Приложение можно запустить утилитой docker-compose следующим образом:

```
docker-compose build
docker-compose up
``` 

Для запуска проекта необходимо склонировать репозиторий и перейти в папку проекта,
создать там виртуальное окружение и активировать его, после чего можно запускать docker-compose.


## API

#### С помощью __/ml_api__ можно:
1. Вернуть список доступных для обучения классов моделей
2. Обучить ML-модель с возможностью настройки и подбора оптимальных значений (grid search) гиперпараметров
3. Рассчитать предсказания конкретной модели (система умеет хранить как обученные модели, так и обучающие и тестовые данные)
4. Обучить заново (на новых данных) и удалить уже обученные модели

Всего реализовано 4 класса моделей:
- Линейные модели
- Метод опорных векторов
- Дерево решений
- Случайный лес

На вход приложение принимает данные в формате json, где все признаки являются количественными, а таргету соответствует последний элемент файла.

#### С помощью __/results__ можно:
Посмотреть статус или результат задачи обучения модели или расчета предсказаний, выполняемой другим контейнером, по ее id.

#### С помощью __/metrics__ можно:
Выполнять CRUD операции с базой данных метрик качества обученных ML-моделей.

## Example
Подробный пример использования приложения представлен в ноутбуке [API-example.ipynb](API-example.ipynb).

## Database
Работоспособность базы данных была проверена как Flask-приложением (все операции CRUD выполняются корректно), 
так и в DBeaver (хост – localhost, порт – 5432, база данных – postgres, пользователь – postgres, пароль – password), 
где можно непосредственно убедиться, что база данных создается и заполняется записями, 
которые можно считать, изменить или удалить.

## Docker
Получившееся приложение собрано в Docker-образы и они опубликованы в DockerHub:
- web: https://hub.docker.com/repository/docker/annasverk/hw2_web
- worker: https://hub.docker.com/repository/docker/annasverk/hw2_worker

Для Redis и Postgres использовались уже готовые образы из DockerHub.

Приложение можно запустить утилитой docker-compose. Все контейнеры поднимаются, 
что проверено в приложении Docker Desktop.